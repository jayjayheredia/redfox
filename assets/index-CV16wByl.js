import{initializeApp as p}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";import{getFirestore as f,collection as m,query as g,where as h,getDocs as d,addDoc as y}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";import{getAuth as b}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function a(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=a(e);fetch(e.href,t)}})();const w={apiKey:"AIzaSyDu5IjABSjp7U8_0OvllhM0GcMnXUzwsJQ",authDomain:"turno-fdd1b.firebaseapp.com",projectId:"turno-fdd1b",storageBucket:"turno-fdd1b.firebasestorage.app",messagingSenderId:"253806761280",appId:"1:253806761280:web:45af732a9418f0c46b96a5"},l=p(w),I=f(l);b(l);document.addEventListener("DOMContentLoaded",async function(){const c=document.getElementById("calendar"),o=m(I,"turnos"),a=async()=>(await d(o)).docs.map(t=>{const r=t.data();return{title:`${r.title} (${r.status})`,start:r.start,color:r.status==="pendiente"?"#facc15":"#22c55e"}}),n=new FullCalendar.Calendar(c,{initialView:"dayGridMonth",locale:"es",selectable:!0,events:await a(),dateClick:async function(e){const t=prompt(`Seleccioná el horario para el día ${e.dateStr} (Ejemplo: 14:30)`);if(!t)return;const r=prompt(`Ingresa tu nombre para reservar ${e.dateStr} a las ${t}`);if(!r)return;const i=prompt(`Ingresa un telefono para confirmar el turno ${e.dateStr}`);if(!i)return;const s=`${e.dateStr}T${t}:00`,u=g(o,h("start","==",s));if(!(await d(u)).empty){alert("Este turno ya está reservado. Elegí otro horario.");return}await y(o,{title:r,start:s,phone:i,status:"pendiente"}),alert("Turno solicitado correctamente."),n.addEvent({title:`${r} (pendiente)`,start:s,color:"#facc15"})}});n.render()});
